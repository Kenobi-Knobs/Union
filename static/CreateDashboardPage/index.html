<!DOCTYPE html>
<html>
<body>
<h1>Create dashboard</h1>

<textarea></textarea>
<button>Save</button>
<br>
<a href=""><h4>No dashboard</h4></a>
</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js" integrity="sha512-d9xgZrVZpmmQlfonhQUvTR7lMPtO7NkZMkA0ABN3PHCbKA5nqylQ/yWlFAyY6hYgdF1Qh6nYiuADWwKB4C2WSw==" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script>
    function getCookie(name) {
        const value = `; ${document.cookie}`;
        const parts = value.split(`; ${name}=`);
        if (parts.length === 2) return parts.pop().split(';').shift();
    }

    function refreshLink(){
        $.get("/api/getDashboardToken" )
        .done(function(data){
            data = JSON.parse(data);
            let token = data["token"];
            if (token === "null"){
                $("a").attr("disable", "true");
                $("h4").text("No dashboard");
            }else{
                $("a").attr("disable", "");
                $("a").attr("href", "localhost:8080/dashboard/" + token);
                $("h4").text("localhost:8080/dashboard/" + token);
            }
        });
    }

    $( document ).ready(function() {
        refreshLink();
    });

    $("button").click(function(){
        $.ajax({
            url: '/api/createOrUpdateDashboard',
            type: 'post',
            headers: {
                'csrf': getCookie('csrf_token')
            },
            data: {
                data: $("textarea").val(),
                urls: "https://googled.com , https://google.com"
            },
            dataType: 'json',
            success: function (data) {
                refreshLink();
                alert("success");
            }
        });
    });

</script>
</html>